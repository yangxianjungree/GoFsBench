# 协议解析性能测试

## 1. 使用 json 序列化和反序列化

|协程数/数据（协议126字节）|请求数|qps|耗时ms|cs|
|--|--|--|--|--|
|500|100,000|121359|824|
|1000|100,000|110375|906|
|5000|100,000|80906|1236|
|10000|100,000|67980|1471|
|10|10,000,000|40450|247217 ms|11w|
|50|10,000,000|94147|106216 ms|5+w|
|100|10,000,000|108043|92555 ms|4w|
|500|10,000,000|113930|87773|3w|
|1000|10,000,000|105451|94830|
|5000|10,000,000|93240|107250|
|10000|10,000,000|82715|120896|

## 2. 使用 protobuf 序列化和反序列化

|协程数/数据（协议只需39字节）|请求数|qps|耗时|cs|
|--|--|--|--|--|
|5|100,000|27374|3653 ms|
|10|100,000|56433|1772 ms|
|50|100,000|109170|916 ms|
|100|100,000|121654|822 ms|
|500|100,000|162601|615 ms|
|1000|100,000|112107|892 ms|
|5000|100,000|106157|942 ms|
|10000|100,000|87950|1137 ms|
|5|10,000,000|27874|358757 ms|12w|
|10|10,000,000|46093|216950 ms|11w|
|50|10,000,000|98538|101483 ms|7w|
|100|10,000,000|119047|84000 ms|5w|
|500|10,000,000|157304|63571 ms|2.4w|
|1000|10,000,000|146222|68389 ms|2.2w|
|5000|10,000,000|125368|79765 ms|1.5w|
|10000|10,000,000|132215|75634 ms|

## 3. 结论

协程数越来越多，线程逐渐增加。小于500时，si只有个别比较高；在超过500时，nvcswch/s越来越大
